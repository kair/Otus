<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Otus Monitoring Tool</title>
    <link rel="stylesheet" type="text/css" href="../lib/css/jquery.ui.css" />    
    <link rel="stylesheet" type="text/css" href="../lib/jcalendar/css/jscal2.css" />
    <link rel="stylesheet" type="text/css" href="../lib/jcalendar/css/border-radius.css" />
    <!--[if lte IE 8]><script language="javascript" type="text/javascript" src="../excanvas.min.js"></script><![endif]-->
    <script language="javascript" type="text/javascript" src="../lib/jquery/jquery.js"></script>
    <script language="javascript" type="text/javascript" src="../lib/jquery/jquery.flot.js"></script>
    <script language="javascript" type="text/javascript" src="../lib/jquery/jquery.ui.min.js"></script>
    <script language="javascript" type="text/javascript" src="../lib/jcalendar/js/jscal2.js"></script>
	<script language="javascript" type="text/javascript" src="../lib/jcalendar/js/lang/en.js"></script>
 	<script language="javascript" type="text/javascript" src="../lib/tsd/query.js"></script>
 	<script language="javascript" type="text/javascript" src="../lib/tsd/global.js"></script> 	
 </head>
 <body>
 	<div>
    Time Range From <input size="20" id="cs" name="cs" value={{ cs }}/><button id="cs_btn" type="button">...</button>
    To   <input size="20" id="ce" name="ce" value={{ ce }}/><button id="ce_btn" type="button">...</button>
    <script type="text/javascript">//<![CDATA[
       var cal = Calendar.setup({
          onSelect: function(cal) { cal.hide() },
          showTime: true,
          minuteStep: 1
      });
      cal.manageFields("cs_btn", "cs", "%b %d %Y %H:%M");
      cal.manageFields("ce_btn", "ce", "%b %d %Y %H:%M");
    //]]></script>
    <br>
    Metric Name <input type="text" size="20" id="metric" name="metric"/>
    MapReduce Job ID <input type="text" size="20" id="mrjobid" name="mrjobid"/>
	<button type="button" onclick=freshTime()> Go </button>
	</div>
	     	
    <h1>Cluster Overview</h1>

    <div id="clusterview" style="font-size:150%;width:800px;height:300px;"></div>
    
    <h1>Node Overview</h1>
    Node ID <input type="text" size="20" id="nodeid" name="nodeid"/>
	<button type="button"> Go </button>

    <div id="nodeview" style="font-size:150%;width:800px;height:300px;"></div>

    <script type="text/javascript">
    	function freshTime() {
    		$("#test_area").html($("#cs").val()+$("#ce").val());
    	}
    	
    	// Initialize jobid suggestion

    	$("#metric").autocomplete( {
    		delay: 100,
    		source: function(request, response) {
    			$.getJSON(SuggestURL+"&term="+request.term+"&callback=?", function(data) {
    				response(data);	
    			});
    		}
    	});
    	
    	$("#mrjobid").autocomplete( {
    		delay: 100,
    		source: function(request, response) {
    			$.getJSON(SuggestURL+"&term="+request.term+"&callback=?", function(data) {
    				response(data);	
    			});
    		}
    	});
    	
    	// Initialize cluster view
    	var conf = new Object();
    	conf.metric = "cpu_user_time";
    	conf.aggfunc = "sum";
    	conf.isRate = false;
    	conf.downSampe = null;
    	conf.proclist = [];
    	conf.joblist = [];
    	renderView($("#cs").val(), $("#ce").val(), getClusterView, conf, "#clusterview");
    	

    	// Initialize node view
    	var conf = new Object();
    	conf.metric = "cpu_user_time";
    	conf.aggfunc = "sum";
    	conf.isRate = false;
    	conf.downSampe = null;
    	conf.proclist = [];
    	conf.joblist = [];
    	conf.hostid = "cloud1";
    	renderView($("#cs").val(), $("#ce").val(), getNodeView, conf, "#nodeview");
    	
    </script>
 </body>
</html>
